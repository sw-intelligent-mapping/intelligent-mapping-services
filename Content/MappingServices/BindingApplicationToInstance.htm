<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Getting started with Intelligent Mapping and Dynamic Mapping services">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Binding an application to a service instance</title>
        <link href="../Resources/Stylesheets/swStyles.css" rel="stylesheet" />
        <meta name="description" content="This article describes how you can binding an application to an Intelligent Mapping Service Instance. Intelligent Mapping and Dynamic Mapping Services." />
        <script src="../../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <div class="header"><a name="kanchor2"></a>
            <h1>Binding an application to a service instance</h1>
            <p class="sw_version">Intelligent Mapping and Dynamic Mapping services</p>
        </div>
        <div class="footer">
            <table style="width: 100%;margin-left: 0;margin-right: auto;">
                <col style="width: 59px;" />
                <col />
                <col style="width: 100px;" />
                <col style="width: 200px;" />
                <tbody>
                    <tr>
                        <td>
                            <p class="sw_copyright"><a href="../A_Navigation/Copyright/swCopyright.htm" title="Copyright and trademark information" alt="Copyright and trademark information" class="sw_copyright">Â© <span class="CopyrightCopyright">GE</span></a>
                            </p>
                        </td>
                        <td>
                            <p class="sw_footer_title">Binding an application to a service instance</p>
                        </td>
                        <td>
                            <p class="sw_update"><a href="#" onclick="javascript: window.location.href ='mailto:swdocs@ge.com?subject=(Predix) Feedback on article: '+document.title;" class="sw_copyright" title="Send feedback on this article">Send feedback</a>
                            </p>
                        </td>
                        <td>
                            <p class="sw_update">Last update: 28th September 2016</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="article">
            <h3>Before you begin</h3>
            <p>You must <a href="CreateInstance.htm" class="MCXref xref" xrefformat="{paratext}">Create a mapping service instance</a> before you perform this step.</p>
            <p>Cloud Foundry runtime uses the VCAP_SERVICES environment variable to communicate with a deployed application about its environment. To provision connection details for your service instance in the VCAP_SERVICES environment variable, you must bind your instance to your application.</p>
            <h3>Procedure</h3>
            <ol>
                <li value="1">	Create an application that uses the mapping service.</li>
                <li value="2">Create a <i>manifest.yml</i> text file  in the same directory as your application. In this file set the name of your web application as follows:</li>
                <li class="continuation">
                    <div class="code"><pre>#</pre><pre>applications:</pre><pre>- name:</pre><pre>&lt;YourAppName&gt;</pre>
                    </div>
                </li>
                <li value="3">Push the application to Cloud Foundry. At the command prompt enter:</li>
                <li class="code">cf push</li>
                <li value="4">Check that your web application is listed in your Cloud Foundry space:</li>
                <li class="code">cf apps</li>
                <li value="5">Bind your application to the service instance by entering the following command:</li>
                <li class="code">cf bind-service &lt;your_app_name&gt; &lt;my_service_instance_name&gt;</li>
                <li class="continuation">For example:</li>
                <li class="code">cf bind-service my-web-app example-ims</li>
                <li class="continuation">Your application is bound to the <code>&lt;my_service_instance_name&gt;</code> instance, and Cloud Foundry returns the a confirmation message. For example:</li>
                <li class="continuation">
                    <div class="code"><pre>Binding service &lt;my_service_instance_name&gt; to app &lt;your_app_name&gt; in org myorg / space predix as userx@ge.com...</pre><pre>OK</pre>
                    </div>
                </li>
                <li class="continuation">
                    <p class="Tip">Use the <code>cf restage</code> command to make sure your environmental variable changes take effect.</p>
                </li>
                <li value="6">Enter the following command to verify the binding:</li>
                <li class="code">cf env &lt;your_app_name&gt;</li>
                <li class="continuation">A message similar to the following is returned:</li>
                <li class="continuation">
                    <div class="code"><pre>Getting env variables for app your_app_name in org cf_org_name / space cf_space_name as cf_user_name...</pre><pre>OK</pre><pre>{</pre><pre> "VCAP_SERVICES": {</pre><pre>  "intelligent-mapping": [</pre><pre>   {</pre><pre>    "credentials": {</pre><pre>     "instanceId": "69c2bd61-4526-4379-9533-a2721fe83ba8",</pre><pre>     "uri": "http://&lt;production URL&gt;",</pre><pre>     "zone": {</pre><pre>      "http-header-name": "Predix-Zone-Id",</pre><pre>      "http-header-value": "69c2bd61-4526-4379-9533-a2721fe83ba8",</pre><pre xml:space="preserve">      "oauth-scope": "intelligent-mapping.zones.69c2bd61-4526-4379-9533-a2721fe83ba8.user"</pre><pre>     }</pre><pre>    },</pre><pre>    "label": "intelligent-mapping",</pre><pre>    "name": "&lt;service instance name&gt;",</pre><pre xml:space="preserve">    "plan": "Tiered",</pre><pre>    "tags": []</pre><pre>   }</pre><pre>  ]</pre><pre> }</pre><pre>}</pre><pre> "predix-uaa": [</pre><pre>   {</pre><pre>    "credentials": {</pre><pre>     "issuerId": "https://a14f01fc-f50e-4db7-8bb0-bed1c887ea98.predix-uaa.run.aws-usw02-pr.ice.predix.io/oauth/token",</pre><pre>     "uri": "https://a14f01fc-f50e-4db7-8bb0-bed1c887ea98.predix-uaa.run.aws-usw02-pr.ice.predix.io",</pre><pre>     "zone": {</pre><pre>      "http-header-name": "X-Identity-Zone-Id",</pre><pre>      "http-header-value": "a14f01fc-f50e-4db7-8bb0-bed1c887ea98"</pre><pre>     }</pre><pre>    },</pre><pre>    "label": "predix-uaa",</pre><pre>    "name": "my_uaa_instance",</pre><pre>    "plan": "Tiered",</pre><pre>    "provider": null,</pre><pre>    "syslog_drain_url": null,</pre><pre>    "tags": []</pre><pre>   }</pre><pre>  ]</pre><pre> }</pre><pre>}</pre>
                    </div>
                </li>
                <li class="continuation">
                    <div class="notes">
                        <ul>
                            <li value="1">The <i>&lt;production URL&gt;</i> depends on your Predix.io registration, that is <i>aws-usw02-.pr.ice.predix.io</i> for US West or <i>asv-.pr.ice.predix.io</i> for US East.</li>
                            <li value="2">The <b>VCAP_SERVICES</b> provides the oauth-scope.</li>
                            <li value="3">The <b>predix-uaa</b> section provides the "<code>uri": "https://a14f01fc-f50e-4db7-8bb0-bed1c887ea98.predix-uaa.run.aws-usw02-pr.ice.predix.io</code>", which is used when logging in to the Predix Starter Kit.</li>
                        </ul>
                    </div>
                </li>
            </ol>
            <p><b>Next Step</b>
            </p>
            <p><a href="UpdatingOAuth2ClientToUseInstance.htm" class="MCXref xref" xrefformat="{paratext}">Updating OAuth2 client to use your service instance</a>
            </p>
        </div>
    </body>
</html>